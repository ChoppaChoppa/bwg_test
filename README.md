# bwg_test

**ввод средств**

создает новую транзакцию в бд, при удачном запросе возвращает оповещение, что транзакция находится в обработке

Request:

`[POST] transaction/in`

Body:
```json
{
  "user_id": 0,
  "amount": 123.0
}
```

Response:
```json
{
  "error": false,
  "error_text": "",
  "data": null,
  "code": 200
}
```

**вывод средств**

создает новую транзакцию в бд, при удачном запросе возвращает оповещение, что транзакция находится в обработке

Request:

`[POST] transaction/out`

Body:
```json
{
  "user_id": 0,
  "amount": 123.0
}
```

Response:
```json
{
  "error": false,
  "error_text": "",
  "data": null,
  "code": 200
}
```

## Алгоритм работы

при запуске сервиса, запускается функция, которая считывает не обработанные транзакции из базы и запускает воркер,
который в зависимости от типа транзакции их обрабатывает (если количество попыток обработать транзакцию первысело 5,
то статус транзакции будет установлен как необрабатываемый и больше не будет взят в обработку),

если кол-во транзакций превышает некоторое заранее установленное n, то данный воркер вызвает новый воркер(рекурсивно)
передавая туда копию массива транзакций начиная с n элемента, а сам обработает транзакции до n элементов

**Пример**

если у нас есть массив **[1, 2, 3, 4, 5, 6, 7, 8]** и **n = 2**, то кол-во воркеров будет 4 и обрабатывать,
начиная с 1 воркера, будут: **[1, 2], [3, 4], [4, 5], [6, 8]**

есть две ручки, которые служат для создания транзакции, после создания транзакции,
они будут обработанны ранее запущенными воркерами.